---
title: "Econ Stats R Assignment 5"
author: "Kelsey McKenna and Liu Liu"
date: "4/26/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(cowplot)
library(stringr)
library(datasets)
```

```{r}
summary(swiss)
swiss <- swiss
r <- cor(swiss$Education,swiss$Fertility )
sx <- sd(swiss$Education)
sy <- sd(swiss$Fertility)
beta_hat <-(r*sy)/sx
r
sx
sy
beta_hat
alpha_hat <- mean(swiss$Fertility)- (mean(swiss$Education))*beta_hat
alpha_hat 
40*(beta_hat)+alpha_hat
model_1 <- lm(Fertility ~ Education, swiss)
summary(model_1)
ggplot(data = swiss, aes(x=Education, y=Fertility))+
  geom_jitter()+
  ggtitle("Education vs. Fertility")+
  geom_smooth(method = "lm")
plot(swiss$Education, model_1$residuals, xlab="Education", ylab="Residuals", main="Residuals")
mean(model_1$residuals)

model_2 <- lm(Fertility ~ Catholic, swiss)
model_2
summary(model_2)
```
####1. 
The mean for fertility is 70.14 and median is 70.4, education's mean is 10.98 and median is 8 and catholic's mean is 41.144 and median is 15.14. 


####2. 
a. The correlation between education and fertility is -.66379. The standard deviation of education is 9.615 and the standard deviation of fertility is 12.492. 
b. We find our Beta to be -.86235. 
c. Alpha is 79.61006. 


####3. 
We can predict the fertility rate to be 26.181 at 40% education beyond primary school. 

####4. 
See plot. 

####5. 
b. The beta and alpha are the same for both models. 
c. The R-squared from this model is .4406 and this means that our linear model is an ok fit for the data, but isn't the absolute best just average. If it were closer to 1 it would be a better fit. 
####6. 
a. The median value as seen from the residual is less than the linear regreassion and the data can be at most 19.689 away from the linear model. 
The coefficients express 

####7. 
See plot. 

####8. 
See residual plot. It seems that as education increases the residual or the distance from linear regression gets smaller. 

####9. 
See code above. We get a really really miniscule (approximately 0) number for the mean of the residuals. -7.17*10^(-16) or -.000000000000000717. 

####10. 
a. beta=.1389 or for a one unit increase in percent catholic, the fertility increases by .1389 units. 
b. Yes, because our p-value is very low, .001029 our results are statistically significant. 
c. The R squared is lower (.215) for this model indicating the model is a worse fit for this one. 
